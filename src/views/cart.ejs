<!DOCTYPE html>
<html lang="es">

<head>
    <%- include('partials/head') %>
</head>

<body>

    <%- include('partials/header') %>

        <section class="cart-page">

            <div>
                <h2>Carrito de Compras</h2>

                <% if (cart.length===0) { %>
                    <p>Tu carrito estÃ¡ vacÃ­o.</p>
                    <% } else { %>
                        <% cart.forEach(product=> { %>
                            <div class="cart-item">
                                <img src="<%= product.image %>" alt="<%= product.name %>">
                                <div>
                                    <h4>
                                        <%= product.name %>
                                    </h4>
                                    <p>Precio: $<%= product.price %>
                                    </p>
                                    <p>Cantidad: <%= product.quantity %>
                                    </p>
                                    <form action="/cart/remove/<%= product.id %>" method="POST"
                                        style="display: flex; align-items: center; gap: 10px; margin-top: 10px;">
                                        <input type="number" name="quantity" min="1" max="<%= product.quantity %>"
                                            value="1"
                                            style="width: 50px; padding: 5px; border: 1px solid #ddd; border-radius: 4px;" />
                                        <button type="submit"
                                            style="background: none; border: none; color: #ef4444; cursor: pointer; font-size: 1.2rem; padding: 5px;"
                                            title="Eliminar del carrito">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </form>
                                </div>
                            </div>
                            <% }) %>
                                <% } %>
            </div>

            <div class="summary">
                <h3>Resumen</h3>
                <p>Productos: $<%= total %>
                </p>
                <p>EnvÃ­o: Gratis</p>
                <hr>
                <h3>Total: $<%= total %>
                </h3>
                <a href="/"><button class="buy"
                        style="background-color: transparent; border: 2px solid #ccc; color: #333;">SEGUIR
                        COMPRANDO</button></a>

                <% if (cart.length> 0) { %>
                    <% if (typeof user !=='undefined' && user) { %>
                        <form action="/orders/checkout" method="POST" style="margin-top: 10px;">
                            <button type="submit" class="buy" style="background-color: #10b981;">FINALIZAR
                                COMPRA</button>
                        </form>
                        <% } else { %>
                            <a href="/users/login"
                                style="display:block; text-align:center; margin-top:10px; background-color: #3b82f6; color: white; padding: 1rem; border-radius: 8px; text-decoration: none; font-weight: bold;">INICIAR
                                SESIÃ“N PARA COMPRAR</a>
                            <% } %>
                                <% } %>

                                    <p style="margin-top: 1rem;">ðŸ”’ Pago seguro (Simulado)</p>
            </div>

        </section>

        <%- include('partials/footer') %>

</body>

</html>